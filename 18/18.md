# Problem 18 â€” Galois-Stable Subsets with Trace-Exclusion in Finite Field Extensions

## Problem Statement

Let $p$ be a prime ($17 \leq p \leq 67$, $p \equiv 1 \pmod{4}$), and let $\mathbb{F}_{p}$ denote the finite field of order $p$.  
Let $g(x)$ be an irreducible monic polynomial of degree $d$ ($3 \leq d \leq 7$) over $\mathbb{F}_{p}$.

Define $K = \mathbb{F}_p[x]/(g(x))$, a degree-$d$ extension of $\mathbb{F}_p$.  
The **Galois group** of $K/\mathbb{F}_p$ acts naturally on $K$, generated by the automorphism $\sigma: x \mapsto x^p$.

Let $S$ be a subset of the $p^d$ elements of $K$ that satisfies:

1. **Galois Stability:** $S$ is invariant under all automorphisms in the Galois group (i.e., for every $s \in S$ and every automorphism $\phi$ of $K$, $\phi(s) \in S$).
2. **Trace-Exclusion:** For every $s \in S$, $\mathrm{Tr}_{K/\mathbb{F}_p}(s) \neq 0$.
3. **Sum-Free Under Trace:** For any distinct $s_1, s_2, s_3 \in S$, $\mathrm{Tr}_{K/\mathbb{F}_p}(s_1 + s_2 + s_3) \neq 0$.
4. **Maximality:** Among all such subsets, $S$ is as large as possible.

Your tasks:

- Given $p$, $d$, and the irreducible polynomial $g(x)$,
    - Explicitly construct such a maximal subset $S$ in $K$ (print representatives as polynomials modulo $g(x)$, in lex sorted order),
    - Output the size $k = |S|$ and all elements of $S$ in canonical polynomial representation,
    - For each $s \in S$, output its trace,
    - For each distinct triple $s_1, s_2, s_3 \in S$, output $\mathrm{Tr}(s_1 + s_2 + s_3)$ for verification.

---

## Input

- First line: $p~d$ ($17 \leq p \leq 67$, $p \equiv 1 \pmod{4}$, $3 \leq d \leq 7$)
- Second line: $d+1$ coefficients: $g_{d-1}\ ...\ g_0$ (irreducible, monic; $g(x) = x^d + g_{d-1} x^{d-1} + \dots + g_0$; each $g_i \in \mathbb{F}_p$)

---

## Output

- First line: $k$ (maximal size of possible $S$)
- Next $k$ lines: for each $s \in S$, print its canonical polynomial representation $b_0 + b_1 x + ... + b_{d-1} x^{d-1}$
- Next $k$ lines: traces of each $s$, $\mathrm{Tr}_{K/\mathbb{F}_p}(s)$
- For each distinct triple in $S$ (sorted with $s_1 < s_2 < s_3$ in lex order), print $\mathrm{Tr}_{K/\mathbb{F}_p}(s_1 + s_2 + s_3)$

---

## Sample Input

17 3
2 4 7 3

text

---

## Sample Output (Illustrative)

5
1 0 0
0 1 0
0 0 1
1 1 0
2 0 1
7
8
5
13
4
... (all triple traces)

text

---

### Notes

- Elements in $K$ are represented as polynomials of degree < $d$ modulo $g(x)$, with coefficients in $0, \ldots, p-1$.
- Traces are as defined for field extensions: $\mathrm{Tr}_{K/\mathbb{F}_p}(s) = s + \sigma(s) + \cdots + \sigma^{d-1}(s)$.
- All outputs should be in canonical, sorted order for reproducibility.
- For triples, enumerate all $\binom{k}{3}$ ordered distinct triplets as verification.
- The Galois group is cyclic, generated by $\sigma$; sets invariant under this automorphism are unions of orbits.

---

## Constraints

- $17 \leq p \leq 67$, $p \equiv 1\pmod{4}$
- $3 \leq d \leq 7$
- Coefficients $g_i$ are in $0, ..., p-1$, and $g(x)$ irreducible.

---

## Extra Sample Test Cases

19 4
2 0 5 7 3

29 3
3 13 2 1

text

---

## Further Explanation and Requirements

You must:

- Represent elements properly, compute Galois orbits,
- For each $s \in S$, check trace conditions,
- For all triples, check sum-free under trace,
- Maximize $|S|$.

---

**End of Problem**
