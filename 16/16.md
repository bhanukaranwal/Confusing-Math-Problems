# Problem 19 â€” Maximal Zero-Free Additive Subsets in Finite Fields with Exponential Weight Constraints

## Problem Statement

Let $\mathbb{F}_q$ be a finite field of order $q$ with $q$ a prime ($11 \leq q \leq 43$).  
Let $G = \mathbb{F}_q^*$, the set of nonzero elements of $\mathbb{F}_q$.

You are to construct a subset $S \subseteq G$ with these properties:

1. **Zero-Freeness:** For every triple of (not necessarily distinct) elements $x, y, z \in S$, $x + y + z \neq 0$ (modulo $q$).
2. **Exponential Weight Constraint:** Let $\chi$ be a nontrivial additive character (e.g., $\chi(x) = e^{2\pi i x / q}$).  
   The exponential sum $W(S) = \left|\sum_{x \in S} \chi(ax)\right|$ is **strictly less than $|S|/3$ for every $a \in G$**.
3. **Maximality:** $S$ has the largest possible size among all subsets meeting (1) and (2).

Your tasks:

- For a given prime $q$, **find such a subset $S$ of maximal size**, and **output this size and the elements of $S$ (in increasing order modulo $q$)**.
- Additionally, output for each $a \in G$ the exponential sum $W(S)$ to verify the constraint.

---

## Input

- Single integer: $q$ ($11 \leq q \leq 43$, $q$ prime)

---

## Output

- First line: integer $k = |S|$ (maximal size possible)
- Second line: $k$ space-separated integers, the elements of $S$ in increasing order modulo $q$
- Next $q-1$ lines: for $a = 1$ to $q-1$, print $W(S)$ with at least 6 digits of precision

---

## Sample Input

13

text

---

## Sample Output

4
2 3 5 8
1.414214
2.000000
0.000000
1.732051
1.414214
1.000000
0.000000
1.000000
2.000000
1.732051
1.000000
0.000000

text

---

### Notes

- Exponential sums use complex absolute value; for each $a$, sum $\chi(ax)$ over $x \in S$.
- $\chi(x) = \exp(2\pi i x / q)$ (standard additive character).
- All computations are modulo $q$ and over complex numbers.
- Zero-freeness eliminates all solutions to $x + y + z = 0$ among $S$.
- Maximize $S$ given both constraints; output exponential sum for each $a$.

---

## Constraints

- $11 \leq q \leq 43$, $q$ prime

---

## Extra Sample Test Cases

17

23

text

---

## Further Explanation and Requirements

You must:

- Construct/verify maximal zero-free sets under exponential sum bounds,
- Ensure no triple sums to zero, and all exponential sums remain within the specified range,
- Output explicit results and verification for each $a$.

---

**End of Problem**
