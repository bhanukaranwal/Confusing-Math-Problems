# Problem 10 â€” Modular Random Walks with Constrained Probabilities

## Problem Statement

Consider the integers modulo $m$ ($3 \leq m \leq 50$).  
You start at position $0$ modulo $m$. At each step, you may move either $+a_i$ or $-a_i$ (modulo $m$), where the allowable steps $A = [a_1, a_2, ..., a_n]$ are distinct integers ($1 \leq a_i < m$, $2 \leq n \leq 12$).

Each movement $+a_i$ or $-a_i$ is chosen independently with probability $p_i$, with $\sum_{i=1}^n 2p_i = 1$ (that is, for all $i$, you may move $+a_i$ with probability $p_i$ and $-a_i$ with probability $p_i$).

Find, for a chosen length $L$ ($1 \leq L \leq 10$):

- The **maximum possible probability $q$** that, after $L$ steps, the position is exactly $s \neq 0$ (modulo $m$), for any $s \in [1, m-1]$;
- The vector of assigned step probabilities $(p_1, ..., p_n)$ (with rational or decimal values);
- The value $s$ (the position of maximal reachability).

In other words:  
For given $m, n, A, L$:

- Among all possible probability distributions $(p_1, ..., p_n)$ summing to $1/2$ (each $+a_i$ and $-a_i$ gets $p_i$), find the parameters and target $s$ that maximize $\Pr[\text{position after }L \text{ steps} \equiv s \pmod m]$.

---

## Input

- First line: $m~n~L$ ($3 \leq m \leq 50$, $2 \leq n \leq 12$, $1 \leq L \leq 10$)
- Second line: $a_1~a_2~...~a_n$ (distinct, $1 \leq a_i < m$)

---

## Output

- First line: maximal probability $q$ (print at least 8 decimal digits)
- Second line: $s$ (the position modulo $m$)
- Third line: $p_1~p_2~...~p_n$ (space-separated, print at least 8 digits or rational form)

---

## Sample Input

5 2 2
1 2



---

## Sample Output

0.37500000
2
0.25 0.25



---

### Notes

- You may assign step probabilities to maximize the chance of reaching any possible $s \neq 0$ modulo $m$ after $L$ steps.
- Output the maximal achievable $q$, the $s$ for which it is achieved, and your probability vector.

---

## Constraints

- $3 \leq m \leq 50$
- $2 \leq n \leq 12$
- $1 \leq L \leq 10$
- All $a_i$ distinct and $1 \leq a_i < m$

---

## Extra Sample Test Cases

7 3 3
2 3 4

6 2 5
1 5



---

## Further Explanation and Requirements

To solve, you must:

- Consider all possible probability distributions subject to the constraints,
- Simulate or compute the chance of landing at each possible $s$ after $L$ steps,
- Maximize $q$ and output the inputs as requested.

---

**End of Problem**
